<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Free Tarot Reading | Tanner Waldo</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="logo"><a href="index.html">Tanner Waldo</a></div>
      <ul class="nav-links">
        <li><a href="index.html#home">Home</a></li>
        <li><a href="index.html#about">About</a></li>
        <li><a href="index.html#contact">Contact</a></li>
        <li><a href="#" id="openModal">Free Chapter</a></li>
        <li><a href="store.html">Store</a></li>
        <li><a href="tarot.html">Free Tarot Reading</a></li>
      </ul>
    </div>
  </nav>

  <!-- Tarot Section -->
  <section class="section dark">
    <h2>Free Tarot Reading</h2>
    <p>Ask a question, and the cards will guide you. Powered by AI, this tarot reader draws from the full 78-card deck ‚Äî including reversals ‚Äî to give you a personalized reading.</p>

    <form id="tarotForm" class="signup-form">
      <input type="text" id="question" name="question" placeholder="Enter your question..." required>
      <button type="submit">Draw 3 Cards</button>
    </form>

    <div id="reading" style="margin-top: 30px; text-align:left; max-width:600px; margin-left:auto; margin-right:auto;"></div>
  </section>

  <footer>
    <p>&copy; 2025 Tanner Waldo ¬∑ TannerWaldo.com</p>
  </footer>

  <!-- Free Chapter Modal -->
  <div id="chapterModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <h2>Get the First Chapter Free</h2>
      <p>Sign up below to receive a free preview and updates about <em>Every Light in Every Window, Every Tooth in Every Mouth</em>.</p>
      
      <!-- MailerLite Form -->
      <form id="signupForm-tarot" 
            action="https://assets.mailerlite.com/webforms/submit/164309175309960831"
            method="post" 
            target="_blank"
            class="signup-form">

        <input type="email" name="fields[email]" placeholder="Enter your email" required>
        <input type="hidden" name="ml-submit" value="1">
        <input type="hidden" name="anticsrf" value="true">

        <button type="submit">Send Me the Chapter</button>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // Modal open/close
    const modal = document.getElementById("chapterModal");
    const openModal = document.getElementById("openModal");
    const closeModal = document.getElementById("closeModal");

    openModal.onclick = function(e) {
      e.preventDefault();
      modal.style.display = "block";
    }
    closeModal.onclick = function() {
      modal.style.display = "none";
    }
    window.onclick = function(event) {
      if (event.target === modal) {
        modal.style.display = "none";
      }
    }

    // Tarot form submission
    document.getElementById("tarotForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const question = document.getElementById("question").value;
      const readingDiv = document.getElementById("reading");
      readingDiv.innerHTML = "<p>üîÆ Shuffling the deck...</p>";

      try {
        const res = await fetch("https://oracle.twaldo.workers.dev", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ question })
        });

        if (!res.ok) throw new Error("Network response was not ok");

        const data = await res.json();
        readingDiv.innerHTML = `
          <h3>Your Cards:</h3>
          <p>${data.cards.join(", ")}</p>
          <h3>Reading:</h3>
          <p>${data.reading}</p>
        `;
      } catch (err) {
        readingDiv.innerHTML = "<p>‚ö†Ô∏è Oops, something went wrong. Please try again later.</p>";
      }
    });
  </script>

</body>
</html>
